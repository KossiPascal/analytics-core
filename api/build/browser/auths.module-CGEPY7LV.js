import{a as re}from"./chunk-AHA44THY.js";import"./chunk-Y4HZH7QO.js";import{i as ie}from"./chunk-SFQJWOZW.js";import{$a as l,$b as D,Ca as w,Db as K,Ea as g,Fb as W,Gb as F,Hb as m,Ib as I,Jb as j,Ka as i,Kb as M,La as a,Lb as u,Ma as s,Mb as L,N as H,Nb as k,Ob as R,R as $,Ra as y,S as C,Ta as T,U as h,Vb as X,Wa as z,Wb as Y,Xb as Z,Y as x,Z as N,Zb as _,_b as ee,ab as b,ac as f,cc as P,dc as A,ec as te,fc as S,i as V,q as J,qa as d,ra as p,ub as E,wb as Q,y as q,yb as B}from"./chunk-Y4BXPDGL.js";function ue(o,t){if(o&1&&(i(0,"div",31),s(1,"i",32),i(2,"div",33),l(3),a()()),o&2){let G=T();d(3),b(G.LoadingMsg)}}function fe(o,t){o&1&&(i(0,"div",34),l(1," Password does not match "),a())}var ne=(()=>{let t=class t{constructor(e,r,n,c,v){this.store=e,this.auth=r,this.router=n,this.http=c,this.conf=v,this.message="Vous voulez vous enr\xE9gistrer",this.isLoading=!1,this.LoadingMsg="Loading...",this.showRegisterPage=!1,this.passwordType="password"}ngOnInit(){if(this.getConfigs(),!this.showRegisterPage){this.auth.GoToDefaultPage();return}this.authForm=this.createFormGroup()}showHidePassword(){this.passwordType=this.passwordType=="password"?"text":"password"}getConfigs(){}createFormGroup(){return new M({username:new u("",[m.required,m.minLength(4)]),fullname:new u("",[m.required,m.minLength(4)]),email:new u("",[m.required,m.email]),password:new u("",[m.required,m.minLength(8)]),passwordConfirm:new u("",[m.required,m.minLength(8)]),agree_terms:new u(!1,[m.required]),isActive:new u(this.showRegisterPage)},[this.MatchValidator("password","passwordConfirm"),this.AcceptThermeValidator("agree_terms")])}MatchValidator(e,r){return n=>{let c=n.get(e),v=n.get(r);return c&&v&&c.value!==v.value?{mismatch:!0}:null}}AcceptThermeValidator(e){return r=>{let n=r.get(e);return n&&n.value!==!0?{mismatch:!0}:null}}passwordMatchError(){return this.authForm.getError("password")&&this.authForm.get("passwordConfirm")?.touched}register(){}};t.\u0275fac=function(r){return new(r||t)(p(P),p(S),p(_),p(B),p(re))},t.\u0275cmp=x({type:t,selectors:[["app-register"]],decls:50,vars:6,consts:[[1,"login-page","register-page"],[1,"login-box","register-box"],[1,"card","card-outline","card-primary"],[1,"card-header","text-center"],[1,"card-body"],[1,"overlay-wrapper"],["class","overlay",4,"ngIf"],[1,"login-box-msg"],["novalidate","",1,"form-horizontal",3,"ngSubmit","formGroup"],[1,"input-group","mb-3"],["id","username","type","text","placeholder","Username","formControlName","username",1,"form-control"],[1,"input-group-append"],[1,"input-group-text"],[1,"fas","fa-user"],["id","fullname","type","text","placeholder","Full Name","formControlName","fullname",1,"form-control"],["id","email","type","email","placeholder","Email","formControlName","email",1,"form-control"],[1,"fas","fa-envelope"],["id","password","placeholder","Password","formControlName","password",1,"form-control",3,"type"],[1,"input-group-text",3,"click"],[1,"fas","fa-lock"],["id","passwordConfirm","type","password","placeholder","Retype password","formControlName","passwordConfirm",1,"form-control"],["class","btn btn-danger",4,"ngIf"],[1,"row"],[1,"col-7"],[1,"icheck-primary"],["type","checkbox","id","agreeTerms","name","terms","formControlName","agree_terms"],["for","agreeTerms"],["href","#"],[1,"col-md-5"],["color","accent","type","submit",1,"btn","btn-success","btn-block",3,"disabled"],["routerLink","/auths/login",1,"text-center"],[1,"overlay"],[1,"fas","fa-3x","fa-sync-alt","fa-spin"],[1,"text-bold","pt-2"],[1,"btn","btn-danger"]],template:function(r,n){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),s(3,"div",3),i(4,"div",4)(5,"div",5),w(6,ue,4,1,"div",6),i(7,"p",7)(8,"strong"),l(9),a()(),i(10,"form",8),y("ngSubmit",function(){return n.register()}),i(11,"div",9),s(12,"input",10),i(13,"div",11)(14,"div",12),s(15,"span",13),a()()(),i(16,"div",9),s(17,"input",14),i(18,"div",11)(19,"div",12),s(20,"span",13),a()()(),i(21,"div",9),s(22,"input",15),i(23,"div",11)(24,"div",12),s(25,"span",16),a()()(),i(26,"div",9),s(27,"input",17),i(28,"div",11)(29,"div",18),y("click",function(){return n.showHidePassword()}),s(30,"span",19),a()()(),i(31,"div",9),s(32,"input",20),i(33,"div",11)(34,"div",12),s(35,"span",19),a()()(),w(36,fe,2,0,"div",21),i(37,"div",22)(38,"div",23)(39,"div",24),s(40,"input",25),i(41,"label",26),l(42,"J'accepte les "),i(43,"a",27),l(44,"termes"),a()()()(),i(45,"div",28)(46,"button",29),l(47,"register"),a()()()(),i(48,"a",30),l(49,"Me connecter"),a()()()()()()),r&2&&(d(6),g("ngIf",n.isLoading),d(3),b(n.message),d(),g("formGroup",n.authForm),d(17),z("type",n.passwordType),d(9),g("ngIf",n.passwordMatchError()),d(10),g("disabled",!n.authForm.valid))},dependencies:[E,L,F,W,I,j,k,R,ee],styles:[`label[_ngcontent-%COMP%] {
    display: block;
  }`]});let o=t;return o})();function he(o,t){if(o&1&&(i(0,"h6",17),l(1),a()),o&2){let G=T();d(),b(G.message)}}var ae=(()=>{let t=class t{constructor(e,r,n,c){this.userCtx=e,this.auth=r,this.api=n,this.store=c}ngOnInit(){this.auth.isAlreadyLogin,this.loginForm=this.createFormGroup()}createFormGroup(){return new M({credential:new u("",[m.required,m.minLength(3)]),password:new u("",[m.required,m.minLength(4)])})}login(){return this.api.login(this.loginForm.value).subscribe(e=>{if(e.status===200){let r=e.data;this.store.set({db:f,name:"token",value:r}),this.store.set({db:f,name:"countries",value:JSON.stringify(e.countries)}),this.store.set({db:f,name:"regions",value:JSON.stringify(e.regions)}),this.store.set({db:f,name:"prefectures",value:JSON.stringify(e.prefectures)}),this.store.set({db:f,name:"communes",value:JSON.stringify(e.communes)}),this.store.set({db:f,name:"hospitals",value:JSON.stringify(e.hospitals)}),this.store.set({db:f,name:"districtQuartiers",value:JSON.stringify(e.districtQuartiers)}),this.store.set({db:f,name:"villageSecteurs",value:JSON.stringify(e.villageSecteurs)}),this.store.set({db:f,name:"chws",value:JSON.stringify(e.chws)}),this.store.set({db:f,name:"recos",value:JSON.stringify(e.recos)}),location.href=this.userCtx.defaultPage;return}else{this.message=e.data;return}},e=>{this.message=e?.message,console.log(e)})}};t.\u0275fac=function(r){return new(r||t)(p(A),p(S),p(ie),p(P))},t.\u0275cmp=x({type:t,selectors:[["app-login"]],decls:24,vars:3,consts:[[1,"row","h-100","align-items-center","justify-content-center",2,"height","100%","width","100%","padding-top","100px"],[1,"col-12","col-sm-8","col-md-6","col-lg-5","col-xl-4",2,"max-width","500px"],[1,"bg-white","rounded","p-4","p-sm-5","my-4","mx-3"],[2,"width","100%","align-items","center","text-align","center","margin-bottom","5px"],["height","80px","src","assets/logo/ih-logo.png","alt",""],[1,"d-flex","align-items-center","justify-content-between","mb-3"],["href","#",1,""],[1,"app-text-style"],[1,"fa","fa-user-edit","me-2"],["novalidate","",3,"ngSubmit","formGroup"],["style","color: darkred;",4,"ngIf"],[1,"form-floating","mb-3"],["type","text","id","floatingUsername","placeholder","Username","formControlName","credential",1,"form-control",2,"background-color","whitesmoke"],["for","floatingUsername"],["type","password","id","floatingPassword","placeholder","Password","formControlName","password",1,"form-control",2,"background-color","whitesmoke"],["for","floatingPassword"],["type","submit",1,"btn","btn-fifteen","py-2","w-100","mb-4",3,"disabled"],[2,"color","darkred"]],template:function(r,n){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),s(4,"img",4),a(),i(5,"div",5)(6,"a",6)(7,"h3",7),l(8,"Connexion"),a()(),i(9,"h3",7),s(10,"i",8),a()(),i(11,"form",9),y("ngSubmit",function(){return n.login()}),w(12,he,2,1,"h6",10),i(13,"div",11),s(14,"input",12),i(15,"label",13),l(16,"Nom Utilisateur"),a()(),i(17,"div",11),s(18,"input",14),i(19,"label",15),l(20,"Mot de passe"),a()(),s(21,"br"),i(22,"button",16),l(23,"Se connecter"),a()()()()()),r&2&&(d(11),g("formGroup",n.loginForm),d(),g("ngIf",n.message),d(10),g("disabled",!n.loginForm.valid))},dependencies:[E,L,F,I,j,k,R],styles:[".custom-login-container[_ngcontent-%COMP%]{position:fixed!important;top:0!important;left:0!important;width:100vw!important;height:100vh!important;display:flex!important;justify-content:center!important;align-items:center!important}.custom-login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]{width:400px!important;margin:0 auto!important;padding-top:0!important}"]});let o=t;return o})();var U=(()=>{let t=class t{constructor(e,r,n,c,v,me){this.userCtx=e,this.cst=r,this.titleService=n,this.activatedRoute=c,this.router=v,this.auth=me,this.destroy$=new V,this.logoutAccessPages=["auths/lock-screen","auths/login","auths/register","auths/forgot-password"]}canActivate(e,r){if(this.userCtx.isLoggedIn)return this.auth.GoToDefaultPage(),!1;let n=e.data?.title||this.cst.defaultTitle;this.setRouteTitle(n);let c=r.url.substring(1);return this.logoutAccessPages.includes(c)?!0:(this.auth.GoToDefaultPage(),!1)}setRouteTitle(e){this.titleService.setTitle(e)}subscribeToNavigationEnd(){this.router.events.pipe(H(this.destroy$),q(e=>e instanceof Y),J(()=>{let e=this.activatedRoute.firstChild;return e&&e.snapshot.data.title?e.snapshot.data.title:this.cst.defaultTitle})).subscribe(e=>{this.setRouteTitle(e)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};t.\u0275fac=function(r){return new(r||t)(h(A),h(te),h(K),h(Z),h(_),h(S))},t.\u0275prov=$({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var ve=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:ae,canActivate:[U],data:{href:"auths/login",title:"User login"}},{path:"auths/register",component:ne,canActivate:[U],data:{href:"auths/register",title:"User registration"}}],se=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=N({type:t}),t.\u0275inj=C({imports:[D.forChild(ve),D]});let o=t;return o})();var ze=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=N({type:t}),t.\u0275inj=C({imports:[Q,X,se]});let o=t;return o})();export{ze as AuthsModule};
