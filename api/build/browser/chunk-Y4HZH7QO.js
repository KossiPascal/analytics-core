import{a as m,i as U}from"./chunk-SFQJWOZW.js";import{$a as a,Ca as g,Ea as h,Gb as N,Hb as _,Ib as O,Jb as R,Ka as s,Kb as V,La as i,Lb as v,Ma as d,Mb as Q,Nb as A,Ob as B,Pa as M,Pb as P,Qb as H,Ra as f,Rb as j,Sb as z,Ta as T,Wa as D,Y as E,ab as G,bb as F,da as L,ea as x,f as p,qa as u,ra as k,tb as q,ub as I}from"./chunk-Y4BXPDGL.js";function J(o,c){if(o&1&&(s(0,"option",31),a(1),i()),o&2){let l=c.$implicit;D("value",l.id),u(),F(" ",l.name," ")}}function K(o,c){if(o&1&&(s(0,"option",31),a(1),i()),o&2){let l=c.$implicit;D("value",l.id),u(),F(" ",l.name," ")}}function W(o,c){if(o&1&&(s(0,"option",31),a(1),i()),o&2){let l=c.$implicit;D("value",l.id),u(),F(" ",l.name," ")}}function X(o,c){if(o&1&&(s(0,"option",31),a(1),i()),o&2){let l=c.$implicit;D("value",l.id),u(),F(" ",l.name," ")}}function Y(o,c){if(o&1&&(s(0,"option",31),a(1),i()),o&2){let l=c.$implicit;D("value",l.id),u(),F(" ",l.name," ")}}function Z(o,c){if(o&1&&(s(0,"option",31),a(1),i()),o&2){let l=c.$implicit;D("value",l.id),u(),F(" ",l.name," ")}}function ee(o,c){if(o&1&&(s(0,"option",31),a(1),i()),o&2){let l=c.$implicit;D("value",l),u(),F(" ",l.toUpperCase()," ")}}function te(o,c){if(o&1&&(s(0,"option",31),a(1),i()),o&2){let l=c.$implicit;D("value",l.id),u(),F(" ",l.name," ")}}function ie(o,c){o&1&&d(0,"i",32)}function se(o,c){if(o&1){let l=M();s(0,"tbody")(1,"tr")(2,"th")(3,"input",33),f("click",function(){let t=L(l).$implicit,r=T();return x(r.AddOrRemoveData(t))}),i()(),s(4,"td"),a(5),i(),s(6,"td"),a(7),i(),s(8,"td"),a(9),i(),s(10,"td"),a(11),i()()()}if(o&2){let l,e=c.$implicit,t=T();u(3),h("checked",t.containsData(e)),u(2),G(e.id),u(2),G(e.rev),u(2),G((l=e.form)!==null&&l!==void 0?l:e.name),u(2),G(e.user)}}var ce=(()=>{let c=class c{constructor(e){this.api=e,this.responseMsg="",this.foundedDataToDelete=[],this.selectedListToBeDelete=[],this.Countries$=[],this.Regions$=[],this.Prefectures$=[],this.Communes$=[],this.Hospitals$=[],this.DistrictQuartiers$=[],this.VillageSecteurs$=[],this.Families$=[],this.Chws$=[],this.Recos$=[],this.Patients$=[],this.regions$=[],this.prefectures$=[],this.communes$=[],this.hospitals$=[],this.districtQuartiers$=[],this.villageSecteurs$=[],this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this.cibles$=[],this.types$=["reco-data","patients","families","chws-data","mentors-data"],this.constMsg="Loading...",this.initMsg=this.constMsg}dataListToDeleteFilterFormGroup(){return new V({start_date:new v("",[_.required,_.minLength(7)]),end_date:new v("",[_.required,_.minLength(7)]),countries:new v("",[_.required]),regions:new v("",[_.required]),prefectures:new v("",[_.required]),communes:new v("",[_.required]),hospitals:new v("",[_.required]),district_quartiers:new v("",[_.required]),cible:new v("",[_.required]),type:new v("",[_.required])})}ngOnInit(){this._FormGroup=this.dataListToDeleteFilterFormGroup(),this.initAllData()}initAllData(){return p(this,null,function*(){this.isLoading=!0,this.initMsg="Chargement des Pays ...",this.api.GetCountries().subscribe(e=>p(this,null,function*(){e.status==200&&(this.Countries$=e.data),this.initMsg="Chargement des Regions ...",this.api.GetRegions().subscribe(t=>p(this,null,function*(){t.status==200&&(this.Regions$=t.data),this.initMsg="Chargement des Prefectures ...",this.api.GetPrefectures().subscribe(r=>p(this,null,function*(){r.status==200&&(this.Prefectures$=r.data),this.initMsg="Chargement des Communes ...",this.api.GetCommunes().subscribe(n=>p(this,null,function*(){n.status==200&&(this.Communes$=n.data),this.initMsg="Chargement des Hospitaux ...",this.api.GetHospitals().subscribe(b=>p(this,null,function*(){b.status==200&&(this.Hospitals$=b.data),this.initMsg="Chargement des Districts/Quartiers ...",this.api.GetDistrictQuartiers().subscribe($=>p(this,null,function*(){$.status==200&&(this.DistrictQuartiers$=$.data),this.initMsg="Chargement des Villages/Secteurs ...",this.api.GetVillageSecteurs().subscribe(C=>p(this,null,function*(){C.status==200&&(this.VillageSecteurs$=C.data),this.initMsg="Chargement des Familles ...",this.api.GetFamilys().subscribe(y=>p(this,null,function*(){y.status==200&&(this.Families$=y.data),this.initMsg="Chargement des ASC ...",this.api.GetChws().subscribe(S=>p(this,null,function*(){S.status==200&&(this.Chws$=S.data),this.initMsg="Chargement des Reco ...",this.api.GetRecos().subscribe(w=>p(this,null,function*(){w.status==200&&(this.Recos$=w.data),this.isLoading=!1}),w=>{this.isLoading=!1,console.log(w.error)})}),S=>{this.isLoading=!1,console.log(S.error)})}),y=>{this.isLoading=!1,console.log(y.error)})}),C=>{this.isLoading=!1,console.log(C.error)})}),$=>{this.isLoading=!1,console.log($.error)})}),b=>{this.isLoading=!1,console.log(b.error)})}),n=>{this.isLoading=!1,console.log(n.error)})}),r=>{this.isLoading=!1,console.log(r.error)})}),t=>{this.isLoading=!1,console.log(t.error)})}),e=>{this.isLoading=!1,console.log(e.error)})})}SelectAllData(){this.selectedListToBeDelete.length==this.foundedDataToDelete.length?this.selectedListToBeDelete=[]:this.selectedListToBeDelete=this.foundedDataToDelete.map(e=>({_deleted:!0,_id:e.id,_rev:e.rev,_table:e.table}))}containsData(e){let t=this.selectedListToBeDelete.find(r=>r._id===e.id);return t!=null}AddOrRemoveData(e){let[t,r]=(()=>{let n=-1;return[this.selectedListToBeDelete.find(($,C)=>$._id===e.id?(n=C,!0):!1),n]})();r!==-1?this.selectedListToBeDelete.splice(r,1):this.selectedListToBeDelete.push({_deleted:!0,_id:e.id,_rev:e.rev,_table:e.table})}getListOfDataToDeleteFromCouchDb(){this.initMsg=this.constMsg,this.isLoading=!0,this.foundedDataToDelete=[],this.selectedListToBeDelete=[],this.responseMsg="";let e=m(this._FormGroup.value.cible);var t=[];["reco-data","patients","families"].includes(this._FormGroup.value.type)&&(t=this.VillageSecteurs$.filter(n=>e.includes(n.reco_id)).map(n=>n.id));let r={cible:[...e,...t],type:this._FormGroup.value.type,start_date:this._FormGroup.value.start_date,end_date:this._FormGroup.value.end_date};this.api.GetDataToDeleteFromCouchDb(r).subscribe(n=>p(this,null,function*(){console.log(n),n.status==200?this.foundedDataToDelete=n.data.reduce((b,$)=>($&&!b.find(C=>C.id===$.id)&&b.push($),b),[]):this.responseMsg=n.data,this.isLoading=!1}),n=>{console.log(n.error),this.isLoading=!1,this.responseMsg=n.toString()})}deleteSelectedDataFromCouchDb(){this.initMsg=this.constMsg,this.responseMsg="",this.selectedListToBeDelete.length>0?this.api.deleteDataFromCouchDb(this.selectedListToBeDelete,this._FormGroup.value.type).subscribe(e=>p(this,null,function*(){e.status==200?(this.responseMsg="Done successfuly !",this.foundedDataToDelete=[],this.selectedListToBeDelete=[]):this.responseMsg="Problem with query, retry!"}),e=>{console.log(e),this.responseMsg="Error found when deleting ..."}):this.responseMsg="Not data provied!"}ParamsToFilter(){let e=this._FormGroup.value;var t={start_date:e.start_date,end_date:e.end_date,countries:m(e.countries),regions:m(e.regions),prefectures:m(e.prefectures),communes:m(e.communes),hospitals:m(e.hospitals),district_quartiers:m(e.district_quartiers),village_secteurs:m(e.village_secteurs),families:m(e.families),chws:m(e.chws),recos:m(e.recos),patients:m(e.patients),type:e.type};return t}genarateRegions(){this.regions$=[],this.prefectures$=[],this.communes$=[],this.hospitals$=[],this.districtQuartiers$=[],this.villageSecteurs$=[],this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.regions="",this._FormGroup.value.prefectures="",this._FormGroup.value.communes="",this._FormGroup.value.hospitals="",this._FormGroup.value.district_quartiers="",this._FormGroup.value.village_secteurs="",this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=this.Countries$.map(t=>t.id);this.regions$=this.Regions$.filter(t=>e.includes(t.country_id))}genaratePrefectures(){this.prefectures$=[],this.communes$=[],this.hospitals$=[],this.districtQuartiers$=[],this.villageSecteurs$=[],this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.prefectures="",this._FormGroup.value.communes="",this._FormGroup.value.hospitals="",this._FormGroup.value.district_quartiers="",this._FormGroup.value.village_secteurs="",this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=m(this._FormGroup.value.regions);this.prefectures$=this.Prefectures$.filter(t=>e.includes(t.region.id))}genarateCommunes(){this.communes$=[],this.hospitals$=[],this.districtQuartiers$=[],this.villageSecteurs$=[],this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.communes="",this._FormGroup.value.hospitals="",this._FormGroup.value.district_quartiers="",this._FormGroup.value.village_secteurs="",this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=m(this._FormGroup.value.prefectures);this.communes$=this.Communes$.filter(t=>e.includes(t.prefecture.id))}genarateHospitals(){this.hospitals$=[],this.districtQuartiers$=[],this.villageSecteurs$=[],this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.hospitals="",this._FormGroup.value.district_quartiers="",this._FormGroup.value.village_secteurs="",this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=m(this._FormGroup.value.communes);this.hospitals$=this.Hospitals$.filter(t=>e.includes(t.commune.id))}genarateDistrictQuartiers(){this.districtQuartiers$=[],this.villageSecteurs$=[],this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.district_quartiers="",this._FormGroup.value.village_secteurs="",this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=m(this._FormGroup.value.hospitals);this.districtQuartiers$=this.DistrictQuartiers$.filter(t=>e.includes(t.hospital.id))}genarateChws(){this.villageSecteurs$=[],this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.village_secteurs="",this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=m(this._FormGroup.value.district_quartiers);this.chws$=this.Chws$.filter(t=>e.includes(t.district_quartier.id))}genarateVillageSecteurs(){this.villageSecteurs$=[],this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.village_secteurs="",this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=m(this._FormGroup.value.district_quartiers);this.villageSecteurs$=this.VillageSecteurs$.filter(t=>e.includes(t.district_quartier.id))}genarateRecos(){this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=m(this._FormGroup.value.village_secteurs);this.recos$=this.Recos$.filter(t=>e.includes(t.village_secteur.id))}genarateFamilies(){this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let e=m(this._FormGroup.value.village_secteurs);this.families$=this.Families$.filter(t=>e.includes(t.village_secteur.id))}genaratePatients({recos:e,chws:t}){this.chws$=[],this.recos$=[],this.patients$=[],this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="";let r=m(this._FormGroup.value.families);this.patients$=this.Patients$.filter(n=>r.includes(n.family.id))}generateCible(){if(this.families$=[],this.chws$=[],this.recos$=[],this.patients$=[],this.villageSecteurs$=[],this._FormGroup.value.village_secteurs="",this._FormGroup.value.families="",this._FormGroup.value.chws="",this._FormGroup.value.recos="",this._FormGroup.value.patients="",["reco-data","patients","families"].includes(this._FormGroup.value.type)){let e=m(this._FormGroup.value.district_quartiers);this.cibles$=this.Recos$.filter(t=>e.includes(t.district_quartier.id))}else if(this._FormGroup.value.type==="chws-data"){let e=m(this._FormGroup.value.district_quartiers);this.cibles$=this.Chws$.filter(t=>e.includes(t.district_quartier.id))}else this._FormGroup.value.type}};c.\u0275fac=function(t){return new(t||c)(k(U))},c.\u0275cmp=E({type:c,selectors:[["app-user"]],decls:104,vars:15,consts:[[2,"color","red"],[1,"content-header"],[1,"container-fluid"],[1,"card","card-info"],[1,"overlay-wrapper"],[1,"card-header"],["novalidate","",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-sm-3","col-6"],[1,"form-group"],["type","date","formControlName","start_date",1,"form-control",2,"background-color","whitesmoke"],["type","date","formControlName","end_date",1,"form-control",2,"background-color","whitesmoke"],["formControlName","countries",1,"form-control",2,"background-color","whitesmoke",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","regions",1,"form-control",2,"background-color","whitesmoke",3,"change"],["formControlName","prefectures",1,"form-control",2,"background-color","whitesmoke",3,"change"],["formControlName","communes",1,"form-control",2,"background-color","whitesmoke",3,"change"],["formControlName","hospitals",1,"form-control",2,"background-color","whitesmoke",3,"change"],["formControlName","district_quartiers",1,"form-control",2,"background-color","whitesmoke",3,"change"],["formControlName","type",1,"form-control",2,"background-color","whitesmoke",3,"change"],["multiple","","formControlName","cible",1,"form-control",2,"background-color","whitesmoke"],["type","submit",1,"btn","btn-warning","form-control",3,"disabled"],["style","margin-left: 10px;","class","fas fa-1x fa-sync-alt fa-spin",4,"ngIf"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body",2,"margin-top","30px"],["type","button",1,"btn","btn-danger",3,"click","disabled"],[1,"table","datatable"],["type","checkbox","name","","id","",2,"zoom","1.5",3,"click","checked"],[4,"ngFor","ngForOf"],[3,"value"],[1,"fas","fa-1x","fa-sync-alt","fa-spin",2,"margin-left","10px"],["type","checkbox","name","","id","",2,"zoom","1.1",3,"click","checked"]],template:function(t,r){t&1&&(s(0,"h1",0),a(1),i(),s(2,"section",1)(3,"div",2)(4,"h2"),a(5,"Delete Chws Data From Couch Database (Tonoudayo App)"),i(),s(6,"div",3)(7,"div",4)(8,"div",5)(9,"form",6),f("ngSubmit",function(){return r.getListOfDataToDeleteFromCouchDb()}),s(10,"div",7)(11,"div",8)(12,"div",9)(13,"label"),a(14,"Date D\xE9but"),i(),d(15,"input",10),i()(),s(16,"div",8)(17,"div",9)(18,"label"),a(19,"Date Fin"),i(),d(20,"input",11),i()(),s(21,"div",8)(22,"div",9)(23,"label"),a(24,"Country"),i(),s(25,"select",12),f("change",function(){return r.genarateRegions()}),d(26,"option",13),g(27,J,2,2,"option",14),i()()(),s(28,"div",8)(29,"div",9)(30,"label"),a(31,"Region"),i(),s(32,"select",15),f("change",function(){return r.genaratePrefectures()}),d(33,"option",13),g(34,K,2,2,"option",14),i()()(),s(35,"div",8)(36,"div",9)(37,"label"),a(38,"Prefecture"),i(),s(39,"select",16),f("change",function(){return r.genarateCommunes()}),d(40,"option",13),g(41,W,2,2,"option",14),i()()(),s(42,"div",8)(43,"div",9)(44,"label"),a(45,"Commune"),i(),s(46,"select",17),f("change",function(){return r.genarateHospitals()}),d(47,"option",13),g(48,X,2,2,"option",14),i()()(),s(49,"div",8)(50,"div",9)(51,"label"),a(52,"Hospital"),i(),s(53,"select",18),f("change",function(){return r.genarateDistrictQuartiers()}),d(54,"option",13),g(55,Y,2,2,"option",14),i()()(),s(56,"div",8)(57,"div",9)(58,"label"),a(59,"District/Quartier"),i(),s(60,"select",19),f("change",function(){return r.generateCible()}),d(61,"option",13),g(62,Z,2,2,"option",14),i()()(),s(63,"div",8)(64,"div",9)(65,"label"),a(66,"Type"),i(),s(67,"select",20),f("change",function(){return r.generateCible()}),d(68,"option",13),g(69,ee,2,2,"option",14),i()()(),s(70,"div",8)(71,"div",9)(72,"label"),a(73,"Reco/ASC/Mentor"),i(),s(74,"select",21),d(75,"option",13),g(76,te,2,2,"option",14),i()()(),s(77,"div",8)(78,"div",9)(79,"label"),a(80,"."),i(),s(81,"button",22),a(82," Charger les donn\xE9es "),g(83,ie,1,0,"i",23),i()()()()()()(),s(84,"div",24),d(85,"div",25),s(86,"div",26)(87,"button",27),f("click",function(){return r.deleteSelectedDataFromCouchDb()}),a(88," Delete Selected Data From CouchDb "),i(),d(89,"br"),s(90,"table",28)(91,"thead")(92,"tr")(93,"th")(94,"input",29),f("click",function(){return r.SelectAllData()}),i()(),s(95,"th"),a(96,"ID"),i(),s(97,"th"),a(98,"REV"),i(),s(99,"th"),a(100,"Form / Name"),i(),s(101,"th"),a(102,"User"),i()()(),g(103,se,12,5,"tbody",30),i()()()()()()),t&2&&(u(),F(" ",r.responseMsg," "),u(8),h("formGroup",r._FormGroup),u(18),h("ngForOf",r.Countries$),u(7),h("ngForOf",r.regions$),u(7),h("ngForOf",r.prefectures$),u(7),h("ngForOf",r.communes$),u(7),h("ngForOf",r.hospitals$),u(7),h("ngForOf",r.districtQuartiers$),u(7),h("ngForOf",r.types$),u(7),h("ngForOf",r.cibles$),u(5),h("disabled",!r._FormGroup.valid),u(2),h("ngIf",r.isLoading),u(4),h("disabled",!(r.selectedListToBeDelete.length>0)),u(7),h("checked",r.foundedDataToDelete.length>0&&r.selectedListToBeDelete.length==r.foundedDataToDelete.length),u(9),h("ngForOf",r.foundedDataToDelete))},dependencies:[q,I,Q,H,z,N,P,j,O,R,A,B],encapsulation:2});let o=c;return o})();export{ce as a};
