import{Db as m,N as f,R as d,U as i,Wb as p,Xb as v,Zb as j,dc as b,ec as g,fc as y,i as u,q as h,y as l}from"./chunk-6TU3GUAF.js";var w=(()=>{let e=class e{constructor(t,r,s,o,c,a){this.titleService=t,this.cst=r,this.activatedRoute=s,this.router=o,this.userCtx=c,this.auth=a,this.destroy$=new u}canActivate(t,r){let s=this.userCtx.currentUserCtx;if(!this.userCtx.isLoggedIn||!s)return this.auth.logout(),!1;let o=t.data?.href,c=[].concat.apply([]);if(!o||o&&(s.isAdmin||(s.routes??[]).map(a=>a.path).includes(o))){let a=t.data?.title||this.cst.defaultTitle;this.setRouteTitle(a);let R=r.url.substring(1);return!0}else return this.router.navigate(["errors/unauthorized"]),!1}setRouteTitle(t){this.titleService.setTitle(t)}subscribeToNavigationEnd(){this.router.events.pipe(f(this.destroy$),l(t=>t instanceof p),h(()=>{let t=this.activatedRoute.firstChild;return t&&t.snapshot.data.title?t.snapshot.data.title:this.cst.defaultTitle})).subscribe(t=>{this.setRouteTitle(t)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(r){return new(r||e)(i(m),i(g),i(v),i(j),i(b),i(y))},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();export{w as a};
