"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([["src_app_modules_auths_auths_module_ts"],{2758:(T,d,s)=>{s.r(d),s.d(d,{AuthsModule:()=>F});var g=s(4765),i=s(8832),u=s(6651),p=s(3308);const h=["promotion_reports","family_planning_reports","morbidity_reports","malaria_morbidity_reports","household_recaps_reports","pcime_newborn_reports","chws_reco_reports","reco_meg_situation_reports"],b=["reco_vaccination_dashboard","reco_performance_dashboard","reco_chart_performance_dashboard"];var t=s(6769),f=s(8394),m=s(4796),x=s(4224);function O(o,A){if(1&o&&(t.j41(0,"h6"),t.EFF(1),t.k0s()),2&o){const r=t.XpG();t.R7$(),t.JRh(r.message)}}function C(o,A){1&o&&t.nrm(0,"span",17)}let P=(()=>{class o{constructor(r,e,n){this.cst=r,this.auth=e,this.indexdb=n,this.isLoading=!1,this.APP_LOGO=this.cst.APP_LOGO,this.COUNTRY_LOGO=this.cst.COUNTRY_LOGO,this.APP_NAME=this.cst.APP_TITLE}ngOnInit(){this.loginForm=this.createFormGroup()}createFormGroup(){return new i.gE({credential:new i.MJ("",[i.k0.required,i.k0.minLength(3)]),password:new i.MJ("",[i.k0.required,i.k0.minLength(8)])})}login(){var r=this;this.isLoading=!0;const{credential:e,password:n}=this.loginForm.value;var a;this.auth.login({credential:e,password:n}).subscribe({next:(a=(0,p.A)(function*(){const c=yield r.indexdb.getOne("user_info","username");if(!c||c.data!==e){const l=[...h,...b];for(const G of l)yield r.indexdb.deleteAllFromDB({dbName:G});yield r.indexdb.update({dbName:"user_info",newData:{id:"username",data:e}}).then(()=>{})}r.isLoading=!1,location.href="reports"}),function(){return a.apply(this,arguments)}),error:a=>{this.isLoading=!1,this.message=a?.message||"Erreur lors de la connexion"}})}static{this.\u0275fac=function(e){return new(e||o)(t.rXU(f.D),t.rXU(m.u),t.rXU(x.T))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-login"]],standalone:!1,decls:28,vars:6,consts:[[1,"login-body"],[1,"country-logo"],["alt","Country Logo",3,"src"],[1,"country-name"],[1,"country-subname"],[1,"login-form"],[1,"login-header"],["alt","App Logo",3,"src"],[1,"login-title"],["autocomplete","off","novalidate","",3,"ngSubmit","formGroup"],[4,"ngIf"],[1,"form-group"],["type","text","id","username","formControlName","credential","placeholder","Username","autocomplete","off","autocorrect","off","spellcheck","false","autocapitalize","none","required",""],["type","password","id","password","formControlName","password","placeholder","Password","autocomplete","new-password","autocorrect","off","spellcheck","false","autocapitalize","none","required",""],["type","submit",1,"login-button",3,"disabled"],["class","fas fa-1x fa-sync-alt fa-spin",4,"ngIf"],["href","/documentations","target","_blank","rel","noopener noreferrer",1,"documentations"],[1,"fas","fa-1x","fa-sync-alt","fa-spin"]],template:function(e,n){1&e&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"img",2),t.j41(3,"div")(4,"div",3),t.EFF(5,"Integrate Health DHIS 2"),t.k0s(),t.j41(6,"div",4),t.EFF(7,"Welcome to Integrate Health DHIS2"),t.k0s()()(),t.j41(8,"div",5)(9,"div",6),t.nrm(10,"img",7),t.j41(11,"p",8),t.EFF(12,"Connexion"),t.k0s()(),t.j41(13,"form",9),t.bIt("ngSubmit",function(){return n.login()}),t.DNE(14,O,2,1,"h6",10),t.j41(15,"div",11),t.nrm(16,"input",12),t.k0s(),t.j41(17,"div",11),t.nrm(18,"input",13),t.k0s(),t.j41(19,"button",14),t.EFF(20," Se connecter "),t.DNE(21,C,1,0,"span",15),t.k0s(),t.nrm(22,"br")(23,"br")(24,"br")(25,"br"),t.j41(26,"a",16),t.EFF(27,"Documentations"),t.k0s()()()()),2&e&&(t.R7$(2),t.FS9("src",n.COUNTRY_LOGO,t.B4B),t.R7$(8),t.FS9("src",n.APP_LOGO,t.B4B),t.R7$(3),t.Y8G("formGroup",n.loginForm),t.R7$(),t.Y8G("ngIf",n.message),t.R7$(5),t.Y8G("disabled",!n.loginForm.valid||n.isLoading),t.R7$(2),t.Y8G("ngIf",n.isLoading))},dependencies:[g.I,i.qT,i.me,i.BC,i.cb,i.YS,i.j4,i.JD],styles:[".login-body[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#042;color:#fff;margin:0;padding:0;height:100vh;display:flex;justify-content:top;align-items:center;flex-direction:column;text-align:left!important}.documentations[_ngcontent-%COMP%]{text-decoration:none;color:#fff;border-radius:5px;padding:5px 10px;background-color:#727272;float:right}.country-logo[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;display:flex;align-items:center}.country-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px!important;min-height:80px;margin-right:10px}.country-name[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#fff;width:230px}.country-subname[_ngcontent-%COMP%]{font-size:15px;font-weight:400;color:#fff;width:230px}.login-form[_ngcontent-%COMP%]{background-color:#042;border-radius:8px;color:#fff;margin:200px 30px 0;width:350px}.login-header[_ngcontent-%COMP%]{text-align:center}.login-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:120px;text-align:center}.login-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-top:10px;margin-bottom:20px;color:#fff;text-align:center}.form-group[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#042;margin-bottom:8px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px;font-size:20px;border-radius:4px;background-color:#f2f2f2;color:#042;transition:border-color .3s ease,background-color .3s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#042;background-color:#fff;outline:none}.login-button[_ngcontent-%COMP%]{padding:12px;background-color:#063;color:#fff;font-size:16px;font-weight:700;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s ease;margin-top:10px}.login-button[_ngcontent-%COMP%]:hover{background-color:#019149}input[_ngcontent-%COMP%]:-webkit-autofill{background-color:transparent!important;color:inherit!important}@media (max-width: 600px){.login-title[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .login-button[_ngcontent-%COMP%]{font-size:14px}.country-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:30px}}"]})}}return o})();var v=s(6104),y=s(6167),M=s(6098),L=s(8175);const _=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:P,canActivate:[(()=>{class o{constructor(r,e,n,a,c){this.userCtx=r,this.constants=e,this.titleService=n,this.router=a,this.authService=c,this.destroy$=new v.B,this.publicAccessPages=["auths/lock-screen","auths/login","auths/forgot-password"]}canActivate(r,e){var n=this;return(0,p.A)(function*(){const a=yield n.userCtx.isLoggedIn(),c=e.url.slice(1);return n.titleService.setTitle(r.data?.title||n.constants.APP_TITLE),a?(yield n.authService.GoToDefaultPage(),!1):!!n.publicAccessPages.includes(c)||(yield n.authService.GoToDefaultPage(),!1)})()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(e){return new(e||o)(t.KVO(y.i),t.KVO(f.D),t.KVO(M.hE),t.KVO(L.t),t.KVO(m.u))}}static{this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})()],data:{href:"auths/login",title:"User login",access:["_public"]}}];let w=(()=>{class o{static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[u.m.forChild(_),u.m]})}}return o})(),F=(()=>{class o{static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[g.D,i.X1,w]})}}return o})()}}]);